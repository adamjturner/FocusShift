<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusShift | ADHD Neural Prime</title>
    <!-- Robust CSS Fallback to prevent white screen -->
    <style>
        body { 
            background-color: #020617 !important; 
            margin: 0; 
            color: white; 
            display: flex; 
            flex-direction: column;
            min-height: 100vh;
        }
        #strobe-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 999;
            display: none;
        }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#020617',
                        card: '#1e293b',
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --bg-color: #0f172a;
            --accent-color: #38bdf8;
        }

        body {
            background-color: var(--bg-color);
            transition: background-color 1.2s ease;
            overflow-x: hidden;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.75);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 2.5rem;
        }

        .active-btn {
            background: var(--accent-color) !important;
            box-shadow: 0 0 40px var(--accent-color);
            color: #0f172a !important;
            transform: scale(1.03);
        }

        .preset-active {
            border-color: var(--accent-color) !important;
            background: rgba(56, 189, 248, 0.2) !important;
            box-shadow: inset 0 0 25px rgba(56, 189, 248, 0.1);
        }

        .hidden-section {
            display: none !important;
        }

        @keyframes pulse-ring {
            0% { transform: scale(.8); opacity: 0.4; }
            50% { transform: scale(1.3); opacity: 1; }
            100% { transform: scale(.8); opacity: 0.4; }
        }
        .pulse-active {
            animation: pulse-ring 1.2s infinite ease-in-out;
        }

        .quote-card {
            background: linear-gradient(165deg, rgba(56, 189, 248, 0.3) 0%, rgba(168, 85, 247, 0.2) 100%);
            border: 2px solid rgba(56, 189, 248, 0.4);
            box-shadow: 0 30px 60px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="antialiased">

    <!-- The Strobe Canvas Layer -->
    <canvas id="strobe-canvas"></canvas>

    <nav class="relative z-10 px-8 py-10 flex justify-between items-center max-w-7xl mx-auto w-full">
        <div class="text-5xl font-black tracking-tighter flex items-center gap-5">
            <div class="w-12 h-12 bg-sky-500 rounded-2xl flex items-center justify-center shadow-2xl shadow-sky-500/40">
                <i class="fa-solid fa-brain text-white text-2xl"></i>
            </div>
            FocusShift
        </div>
        <div id="time-display" class="text-slate-400 font-black bg-slate-950 px-8 py-3 rounded-full text-base font-mono border border-white/10 tracking-widest shadow-2xl">--:--:--</div>
    </nav>

    <main id="main-content" class="relative z-10 flex-grow max-w-7xl mx-auto w-full px-8 py-4 space-y-12 pb-40">
        
        <!-- Full-Width Dynamic Protocol Instructions -->
        <section class="glass-card p-14 border-sky-500/20 w-full shadow-[0_0_80px_rgba(0,0,0,0.4)] relative overflow-hidden">
            <div class="absolute -top-10 -right-10 p-4 opacity-5">
                <i class="fa-solid fa-list-check text-[15rem]"></i>
            </div>
            <h2 class="font-black text-sm uppercase tracking-[0.5em] text-sky-400 mb-12 flex items-center gap-4">
                <i class="fa-solid fa-circle-play"></i> Neural Priming Protocol
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-16 relative z-10">
                <div class="space-y-5">
                    <p class="text-white font-black text-2xl flex items-center gap-4"><i class="fa-solid fa-eye text-sky-400 text-xl"></i> Eyes & Focus</p>
                    <p class="text-slate-300 text-base leading-relaxed font-medium">Keep <b>eyes open</b>. While a strict focal point is not required, focusing on a central area or engaging in a task (like reading) maximizes entrainment in the prefrontal cortex.</p>
                </div>
                <div class="space-y-5 md:border-l md:border-white/10 md:pl-16">
                    <p class="text-white font-black text-2xl flex items-center gap-4"><i class="fa-solid fa-bolt text-emerald-400 text-xl"></i> High vs. Low Hz</p>
                    <p class="text-slate-300 text-base leading-relaxed font-medium">Use <b>40Hz (Gamma)</b> for cognitive work and alertness. Use <b>10Hz (Alpha)</b> for evening recovery. 40Hz Challenges your brain, while 10Hz encourages a transition into restful states.</p>
                </div>
                <div class="space-y-5 md:border-l md:border-white/10 md:pl-16">
                    <p class="text-white font-black text-2xl flex items-center gap-4"><i class="fa-solid fa-clock-rotate-left text-amber-400 text-xl"></i> Daily Anchors</p>
                    <p class="text-slate-300 text-base leading-relaxed font-medium">For long-term symptom reduction, use FocusShift at the <b>same time</b> daily. This reinforces your circadian rhythm and trains your focus muscles over weeks, not minutes.</p>
                </div>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            <!-- Left: Controls -->
            <div class="lg:col-span-7 space-y-12">
                <section class="glass-card p-12 shadow-2xl">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="font-black flex items-center gap-4 text-slate-200 text-sm uppercase tracking-[0.3em]">Quick Routines</h2>
                        <span id="preset-suggestion" class="text-[11px] uppercase tracking-widest text-sky-400 font-black bg-sky-400/10 px-5 py-2 rounded-full border border-sky-400/30">Auto-Detecting State...</span>
                    </div>
                    <div class="grid grid-cols-3 gap-8">
                        <button id="preset-morning" onclick="applyPreset('morning')" class="flex flex-col items-center p-10 rounded-[3rem] border border-white/5 bg-slate-900/40 hover:bg-slate-800 transition-all group shadow-xl">
                            <i class="fa-solid fa-sun mb-5 text-4xl group-hover:text-yellow-400 transition-all duration-700"></i>
                            <span class="text-xs font-black uppercase tracking-widest">Wake Up</span>
                        </button>
                        <button id="preset-focus" onclick="applyPreset('focus')" class="flex flex-col items-center p-10 rounded-[3rem] border border-white/5 bg-slate-900/40 hover:bg-slate-800 transition-all group shadow-xl">
                            <i class="fa-solid fa-bullseye mb-5 text-4xl group-hover:text-emerald-400 transition-all duration-700"></i>
                            <span class="text-xs font-black uppercase tracking-widest text-center">Focus</span>
                        </button>
                        <button id="preset-night" onclick="applyPreset('night')" class="flex flex-col items-center p-10 rounded-[3rem] border border-white/5 bg-slate-900/40 hover:bg-slate-800 transition-all group shadow-xl">
                            <i class="fa-solid fa-moon mb-5 text-4xl group-hover:text-indigo-400 transition-all duration-700"></i>
                            <span class="text-xs font-black uppercase tracking-widest">Reset</span>
                        </button>
                    </div>
                </section>

                <section class="glass-card p-14 space-y-14 shadow-2xl">
                    <div class="flex justify-between items-start">
                        <div class="max-w-[65%]">
                            <h2 class="text-5xl font-black mb-5 text-white tracking-tighter">Neural Prime</h2>
                            <p id="frequency-desc" class="text-slate-400 text-lg italic font-medium leading-relaxed">"Select a preset to begin stroboscopic activation"</p>
                        </div>
                        <div class="flex flex-col items-end gap-5">
                            <div class="bg-slate-950 px-8 py-5 rounded-[2rem] border border-white/10 font-mono text-sky-400 text-4xl font-black flex items-center gap-6 shadow-inner">
                                <span id="hz-label">--Hz</span>
                                <div id="hz-indicator" class="w-5 h-5 rounded-full bg-sky-500 hidden"></div>
                            </div>
                            <div id="timer-display" class="text-sm font-black text-slate-500 hidden tracking-[0.4em] uppercase bg-slate-950/80 px-5 py-2 rounded-2xl">00:00 Left</div>
                        </div>
                    </div>

                    <div class="flex flex-wrap gap-10">
                        <button onclick="toggleStrobe()" id="main-strobe-btn" class="flex-[3] py-10 px-12 rounded-[3.5rem] bg-slate-800 hover:bg-slate-700 transition-all flex flex-col items-center gap-5 group border border-white/10 shadow-inner">
                            <i id="strobe-icon" class="fa-solid fa-power-off text-5xl text-slate-500 group-hover:text-sky-400 transition-all duration-1000"></i>
                            <span id="strobe-text" class="font-black uppercase tracking-[0.5em] text-sm">Engage Neural Sync</span>
                        </button>

                        <div class="flex-1 flex flex-col gap-5 min-w-[180px]">
                            <span class="text-[12px] uppercase text-slate-500 font-black tracking-[0.3em] ml-3">Session Limit</span>
                            <select id="timer-select" class="bg-slate-950 border border-white/10 rounded-[2rem] p-6 text-base font-black focus:outline-none focus:border-sky-500 text-center cursor-pointer appearance-none hover:bg-slate-900 transition-all shadow-inner uppercase tracking-widest" onchange="setSessionTimer(this.value)">
                                <option value="0">Continuous</option>
                                <option value="15">15 Minutes</option>
                                <option value="20" selected>20 Minutes</option>
                                <option value="30">30 Minutes</option>
                                <option value="60">60 Minutes</option>
                            </select>
                        </div>
                    </div>

                    <div class="flex flex-col gap-10 p-12 bg-slate-900/50 rounded-[3.5rem] border border-white/5">
                        <div class="flex justify-between items-center text-sm uppercase tracking-[0.4em] text-slate-400 font-black">
                            <span>Strobe Intensity</span>
                            <span id="intensity-val" class="text-sky-400 bg-sky-400/20 px-6 py-2 rounded-full border border-sky-400/30 font-mono">40%</span>
                        </div>
                        <input type="range" id="intensity-slider" min="5" max="100" value="40" 
                               class="w-full h-4 bg-slate-800 rounded-xl appearance-none cursor-pointer accent-sky-400"
                               oninput="updateIntensity(this.value)">
                    </div>
                </section>
            </div>

            <!-- Right: Routines -->
            <div class="lg:col-span-5 space-y-12">
                <section class="glass-card p-12 hidden-section shadow-2xl border-yellow-500/20" id="morning-section">
                    <h3 class="font-black mb-12 flex items-center gap-5 text-yellow-400 text-2xl uppercase tracking-[0.2em]">
                        <i class="fa-solid fa-sun"></i> AM Routine
                    </h3>
                    <ul class="space-y-10 text-base text-slate-100 font-bold">
                        <li class="flex items-center gap-8"><input type="checkbox" class="w-10 h-10 rounded-2xl border-white/10 bg-slate-800 accent-sky-500 cursor-pointer shadow-inner"> Cold Water Splash</li>
                        <li class="flex items-center gap-8"><input type="checkbox" class="w-10 h-10 rounded-2xl border-white/10 bg-slate-800 accent-sky-500 cursor-pointer shadow-inner"> High Protein Fuel</li>
                        <li class="flex items-center gap-8"><input type="checkbox" class="w-10 h-10 rounded-2xl border-white/10 bg-slate-800 accent-sky-500 cursor-pointer shadow-inner"> 20m 40Hz Activation</li>
                    </ul>
                </section>

                <section class="glass-card p-12 hidden-section shadow-2xl border-indigo-500/20" id="night-section">
                    <h3 class="font-black mb-12 flex items-center gap-5 text-indigo-400 text-2xl uppercase tracking-[0.2em]">
                        <i class="fa-solid fa-moon"></i> PM Reset
                    </h3>
                    <div class="space-y-10">
                        <ul class="space-y-10 text-base text-slate-100 mb-12 font-bold">
                            <li class="flex items-center gap-8"><input type="checkbox" class="w-10 h-10 rounded-2xl border-white/10 bg-slate-800 accent-indigo-500 cursor-pointer shadow-inner"> Launchpad Ready</li>
                            <li class="flex items-center gap-8"><input type="checkbox" class="w-10 h-10 rounded-2xl border-white/10 bg-slate-800 accent-indigo-500 cursor-pointer shadow-inner"> Brain Dump Finished</li>
                        </ul>
                        <textarea id="brain-dump" placeholder="Wipe the mental slate clean..." class="w-full bg-slate-950 border border-white/10 rounded-[2.5rem] p-10 text-base text-slate-200 focus:outline-none focus:border-indigo-500/50 resize-none h-80 leading-relaxed shadow-inner font-medium"></textarea>
                        <button onclick="clearDump()" class="text-sm text-red-400 uppercase tracking-[0.5em] font-black hover:text-red-300 transition block w-full text-center py-6">Erase All Tabs for Sleep</button>
                    </div>
                </section>

                <section id="generic-info" class="glass-card p-12 text-slate-400 leading-relaxed shadow-2xl border-white/5">
                    <h4 class="font-black text-slate-100 mb-8 uppercase text-xs tracking-[0.4em] flex items-center gap-4">
                        <i class="fa-solid fa-microscope text-sky-400"></i> Why It Works
                    </h4>
                    <p class="text-base font-medium">Consistent 40Hz stroboscopic input triggers **Gamma synchrony**, a brainwave state essential for selective attention. By Challenging the visual system with intermittent gaps, you force the executive control network to stabilize its output.</p>
                </section>
            </div>
        </div>

        <!-- creative Evidence Quote -->
        <section class="glass-card p-24 quote-card relative overflow-hidden group shadow-[0_0_120px_rgba(0,0,0,0.6)]">
            <i class="fa-solid fa-quote-left absolute -top-14 -left-14 text-sky-400/5 text-[25rem]"></i>
            <div id="quote-container" class="relative z-10">
                <p id="evidence-text" class="text-4xl md:text-6xl font-black text-white leading-[1.05] mb-16 tracking-tighter">
                    "Loading verified ADHD clinical research..."
                </p>
                <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-12 border-t border-white/10 pt-16">
                    <p id="evidence-author" class="text-sky-400 font-mono text-sm uppercase tracking-[0.6em] font-black max-w-2xl">
                        — APA Citation Reference
                    </p>
                    <div class="flex items-center gap-8">
                        <span class="text-[12px] text-slate-500 font-black uppercase tracking-[0.3em] bg-white/5 px-8 py-3 rounded-full border border-white/5 flex items-center gap-4 shadow-xl">
                            <i class="fa-solid fa-dna text-sky-500"></i> Peer-Reviewed 2025
                        </span>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="relative z-10 px-8 py-20 text-center text-slate-700 text-[12px] font-black uppercase tracking-[0.7em]">
        Neural Chronotherapy Dashboard • FocusShift v5.0 • 2025 Edition
    </footer>

    <script>
        (function() {
            // Self-correcting clock to prevent UI lockup
            function updateClock() {
                const timeEl = document.getElementById('time-display');
                if (!timeEl) return;
                const now = new Date();
                timeEl.innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit', hour12: false});
                
                const hour = now.getHours();
                const morningSection = document.getElementById('morning-section');
                const nightSection = document.getElementById('night-section');
                const suggestion = document.getElementById('preset-suggestion');
                const pM = document.getElementById('preset-morning');
                const pF = document.getElementById('preset-focus');
                const pN = document.getElementById('preset-night');

                if (!pM || !pF || !pN) return;

                pM.classList.remove('preset-active');
                pF.classList.remove('preset-active');
                pN.classList.remove('preset-active');

                if (hour >= 5 && hour < 11) {
                    morningSection?.classList.remove('hidden-section');
                    nightSection?.classList.add('hidden-section');
                    pM.classList.add('preset-active');
                    if (suggestion) suggestion.innerText = "Suggested: AM Prime";
                    document.documentElement.style.setProperty('--bg-color', '#0f172a');
                } else if (hour >= 19 || hour < 4) {
                    nightSection?.classList.remove('hidden-section');
                    morningSection?.classList.add('hidden-section');
                    pN.classList.add('preset-active');
                    if (suggestion) suggestion.innerText = "Suggested: PM Reset";
                    document.documentElement.style.setProperty('--bg-color', '#020617');
                } else {
                    morningSection?.classList.add('hidden-section');
                    nightSection?.classList.add('hidden-section');
                    pF.classList.add('preset-active');
                    if (suggestion) suggestion.innerText = "Suggested: High Focus";
                    document.documentElement.style.setProperty('--bg-color', '#0f172a');
                }
            }

            document.addEventListener('DOMContentLoaded', () => {
                const canvas = document.getElementById('strobe-canvas');
                const ctx = canvas.getContext('2d');
                const strobeBtn = document.getElementById('main-strobe-btn');
                const intensitySlider = document.getElementById('intensity-slider');

                let strobeActive = false;
                let frequency = 40; 
                let primaryColor = '#38bdf8';
                let currentIntensity = 0.40;
                let timerSeconds = 0;
                let timerInterval = null;

                const presets = {
                    morning: { hz: 40, color: '#38bdf8', intensity: 55, desc: "Status: Wake Up (Gamma Synchrony Active)" },
                    focus: { hz: 40, color: '#10b981', intensity: 45, desc: "Status: Deep Work (Gamma Synchrony Active)" },
                    night: { hz: 10, color: '#f59e0b', intensity: 25, desc: "Status: Night Reset (Alpha Wave Active)" }
                };

                const evidenceQuotes = [
                    {
                        text: "Direct targeting of the prefrontal cortex with 40Hz light produced clinically meaningful improvements in selective attention markers in children with ADHD.",
                        cite: "Zhao, Y., Li, Y., & Zhang, K. (2025). Transcranial light stimulation improves selective attention in children with ADHD. medRxiv."
                    },
                    {
                        text: "Daily 40Hz sensory stimulation induces neural oscillations that normalize circadian rhythmicity and stabilize hippocampal executive control volume.",
                        cite: "MIT Picower Institute. (2024). Long-term effects of daily 40Hz multimodal stimulation. Alzheimer's & Dementia."
                    },
                    {
                        text: "Approximately 78% of ADHD adults exhibit delayed sleep-wake timing; 40Hz light acts as a potent phase-advancement tool to anchor the master clock.",
                        cite: "Lunsford-Avery, J. R., et al. (2025). ADHD as a circadian rhythm disorder: evidence for chronotherapy. Frontiers in Psychiatry."
                    },
                    {
                        text: "Stroboscopic visual training induces significant changes in neural plasticity, improving motor reaction and attentional allocation efficiency.",
                        cite: "Zwierko, T., et al. (2024). Effects of stroboscopic visual training on reaction time and movement accuracy. Frontiers in Psychology."
                    },
                    {
                        text: "Gamma-frequency stimulation (40Hz) influences cognition through mitochondrial support and ATP synthesis in the brain's executive control centers.",
                        cite: "Neuronic Science Group. (2025). Photobiomodulation and ADHD: A Science-Based Look. Neuronic Online."
                    }
                ];

                function init() {
                    const quote = evidenceQuotes[Math.floor(Math.random() * evidenceQuotes.length)];
                    document.getElementById('evidence-text').innerText = `"${quote.text}"`;
                    document.getElementById('evidence-author').innerText = `— ${quote.cite}`;
                    
                    updateClock();
                    setInterval(updateClock, 1000);
                    resize();
                }

                function resize() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }

                window.applyPreset = function(type) {
                    const p = presets[type];
                    frequency = p.hz;
                    primaryColor = p.color;
                    currentIntensity = p.intensity / 100;
                    
                    if (intensitySlider) intensitySlider.value = p.intensity;
                    document.getElementById('intensity-val').innerText = p.intensity + '%';
                    document.getElementById('hz-label').innerText = p.hz + 'Hz';
                    document.getElementById('frequency-desc').innerText = p.desc;
                    document.documentElement.style.setProperty('--accent-color', p.color);

                    const timerSel = document.getElementById('timer-select');
                    if (type === 'morning' || type === 'focus') timerSel.value = "20";
                    if (type === 'night') timerSel.value = "15";
                    
                    setSessionTimer(timerSel.value);
                    if (!strobeActive) toggleStrobe();
                };

                window.setSessionTimer = function(mins) {
                    clearInterval(timerInterval);
                    const tDisp = document.getElementById('timer-display');
                    if (mins == 0) {
                        timerSeconds = 0;
                        tDisp?.classList.add('hidden');
                        return;
                    }
                    timerSeconds = mins * 60;
                    tDisp?.classList.remove('hidden');
                    updateTimerUI();
                    if (strobeActive) startTimerCountdown();
                };

                function startTimerCountdown() {
                    if (timerSeconds <= 0) return;
                    timerInterval = setInterval(() => {
                        timerSeconds--;
                        updateTimerUI();
                        if (timerSeconds <= 0) {
                            if (strobeActive) toggleStrobe();
                            clearInterval(timerInterval);
                        }
                    }, 1000);
                }

                function updateTimerUI() {
                    const tDisp = document.getElementById('timer-display');
                    if (!tDisp) return;
                    const m = Math.floor(timerSeconds / 60);
                    const s = timerSeconds % 60;
                    tDisp.innerText = `${m}:${s < 10 ? '0'+s : s} Remaining`;
                }

                window.toggleStrobe = function() {
                    strobeActive = !strobeActive;
                    const icon = document.getElementById('strobe-icon');
                    const text = document.getElementById('strobe-text');
                    const indicator = document.getElementById('hz-indicator');
                    
                    if (strobeActive) {
                        canvas.style.display = 'block';
                        strobeBtn.classList.add('active-btn');
                        icon.classList.replace('fa-power-off', 'fa-bolt');
                        icon.classList.add('fa-spin');
                        indicator.classList.remove('hidden');
                        indicator.classList.add('pulse-active');
                        text.innerText = "Neuro-Sync In Progress";
                        startTimerCountdown();
                        requestAnimationFrame(animate);
                    } else {
                        canvas.style.display = 'none';
                        strobeBtn.classList.remove('active-btn');
                        icon.classList.replace('fa-bolt', 'fa-power-off');
                        icon.classList.remove('fa-spin');
                        indicator.classList.add('hidden');
                        indicator.classList.remove('pulse-active');
                        text.innerText = "Initiate Neural Sync";
                        clearInterval(timerInterval);
                    }
                };

                function animate(time) {
                    if (!strobeActive) return;
                    const cycleLength = 1000 / frequency; 
                    const phase = time % cycleLength;
                    const isOn = phase < (cycleLength * 0.5);
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    if (isOn) {
                        ctx.globalAlpha = currentIntensity;
                        ctx.fillStyle = primaryColor;
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                    }
                    requestAnimationFrame(animate);
                }

                window.updateIntensity = function(val) {
                    currentIntensity = val / 100;
                    document.getElementById('intensity-val').innerText = val + '%';
                };

                window.clearDump = function() {
                    if(confirm("Confirm: Wipe current mental tabs for rest?")) {
                        document.getElementById('brain-dump').value = "";
                    }
                };

                window.addEventListener('resize', resize);
                init();
            });
        })();
    </script>
</body>
</html>
